"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_src_lib_provider_replicate_ts";
exports.ids = ["_rsc_src_lib_provider_replicate_ts"];
exports.modules = {

/***/ "(rsc)/./src/lib/provider/replicate.ts":
/*!***************************************!*\
  !*** ./src/lib/provider/replicate.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   runReplicate: () => (/* binding */ runReplicate)\n/* harmony export */ });\n/* harmony import */ var replicate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! replicate */ \"(rsc)/./node_modules/replicate/index.js\");\n/* harmony import */ var replicate__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(replicate__WEBPACK_IMPORTED_MODULE_0__);\n\nconst DEFAULTS = {\n    steps: 32,\n    guidance: 4.2,\n    aspect: \"3:4\",\n    megapixels: \"1\",\n    lora_scale: 1\n};\nasync function resolveModelIdentifier(rawModel, client) {\n    // Allow env forms: \"owner/model:version\", \"owner/model:latest\", or just \"owner/model\"\n    const hasVersion = rawModel.includes(\":\") && !rawModel.endsWith(\":latest\");\n    if (hasVersion) return rawModel;\n    const slug = rawModel.replace(\":latest\", \"\");\n    const [owner, name] = slug.split(\"/\");\n    if (!owner || !name) throw new Error('Invalid model slug; expected \"owner/model\"');\n    const model = await client.models.get(owner, name);\n    const latestVersionId = model?.latest_version?.id;\n    if (!latestVersionId) throw new Error(\"Unable to resolve latest model version\");\n    return `${model.owner}/${model.name}:${latestVersionId}`;\n}\nasync function runReplicate({ prompt, seed, steps, guidance, aspect, megapixels, lora_scale, signal }) {\n    const token = process.env.REPLICATE_API_TOKEN;\n    const model = process.env.REPLICATE_MODEL;\n    console.log(\"[replicate] env set:\", {\n        hasToken: Boolean(token),\n        hasModel: Boolean(model)\n    });\n    if (!token || !model) throw new Error(\"Missing Replicate env vars\");\n    const replicate = new (replicate__WEBPACK_IMPORTED_MODULE_0___default())({\n        auth: token,\n        userAgent: \"sacred-styles-web\"\n    });\n    // Support versionless or \":latest\" model references by resolving to the latest version id\n    const modelIdentifier = await resolveModelIdentifier(model, replicate);\n    const input = {\n        prompt,\n        seed: seed ?? 89,\n        num_inference_steps: steps ?? DEFAULTS.steps,\n        guidance_scale: guidance ?? DEFAULTS.guidance,\n        aspect_ratio: aspect ?? DEFAULTS.aspect,\n        megapixels: megapixels ?? DEFAULTS.megapixels,\n        lora_scale: lora_scale ?? DEFAULTS.lora_scale,\n        num_outputs: 1,\n        output_format: \"webp\",\n        output_quality: 80\n    };\n    const output = await replicate.run(modelIdentifier, {\n        input\n    });\n    const first = Array.isArray(output) ? output[0] : output;\n    const imageUrl = typeof first === \"string\" ? first : first?.url?.() ?? String(first);\n    return {\n        imageUrl,\n        meta: {\n            steps: DEFAULTS.steps,\n            guidance: DEFAULTS.guidance,\n            aspect: DEFAULTS.aspect\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Byb3ZpZGVyL3JlcGxpY2F0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBa0M7QUFhbEMsTUFBTUMsV0FBVztJQUNmQyxPQUFPO0lBQ1BDLFVBQVU7SUFDVkMsUUFBUTtJQUNSQyxZQUFZO0lBQ1pDLFlBQVk7QUFDZDtBQUVBLGVBQWVDLHVCQUF1QkMsUUFBZ0IsRUFBRUMsTUFBaUI7SUFDdkUsc0ZBQXNGO0lBQ3RGLE1BQU1DLGFBQWFGLFNBQVNHLFFBQVEsQ0FBQyxRQUFRLENBQUNILFNBQVNJLFFBQVEsQ0FBQztJQUNoRSxJQUFJRixZQUFZLE9BQU9GO0lBRXZCLE1BQU1LLE9BQU9MLFNBQVNNLE9BQU8sQ0FBQyxXQUFXO0lBQ3pDLE1BQU0sQ0FBQ0MsT0FBT0MsS0FBSyxHQUFHSCxLQUFLSSxLQUFLLENBQUM7SUFDakMsSUFBSSxDQUFDRixTQUFTLENBQUNDLE1BQU0sTUFBTSxJQUFJRSxNQUFNO0lBQ3JDLE1BQU1DLFFBQVEsTUFBTSxPQUFnQkMsTUFBTSxDQUFDQyxHQUFHLENBQUNOLE9BQU9DO0lBQ3RELE1BQU1NLGtCQUFtQkgsT0FBZUksZ0JBQWdCQztJQUN4RCxJQUFJLENBQUNGLGlCQUFpQixNQUFNLElBQUlKLE1BQU07SUFDdEMsT0FBTyxDQUFDLEVBQUUsTUFBZUgsS0FBSyxDQUFDLENBQUMsRUFBRSxNQUFlQyxJQUFJLENBQUMsQ0FBQyxFQUFFTSxnQkFBZ0IsQ0FBQztBQUM1RTtBQUVPLGVBQWVHLGFBQWEsRUFBRUMsTUFBTSxFQUFFQyxJQUFJLEVBQUV6QixLQUFLLEVBQUVDLFFBQVEsRUFBRUMsTUFBTSxFQUFFQyxVQUFVLEVBQUVDLFVBQVUsRUFBRXNCLE1BQU0sRUFBVztJQUluSCxNQUFNQyxRQUFRQyxRQUFRQyxHQUFHLENBQUNDLG1CQUFtQjtJQUM3QyxNQUFNYixRQUFRVyxRQUFRQyxHQUFHLENBQUNFLGVBQWU7SUFDekNDLFFBQVFDLEdBQUcsQ0FBQyx3QkFBd0I7UUFDbENDLFVBQVVDLFFBQVFSO1FBQ2xCUyxVQUFVRCxRQUFRbEI7SUFDcEI7SUFDQSxJQUFJLENBQUNVLFNBQVMsQ0FBQ1YsT0FBTyxNQUFNLElBQUlELE1BQU07SUFFdEMsTUFBTXFCLFlBQVksSUFBSXZDLGtEQUFTQSxDQUFDO1FBQUV3QyxNQUFNWDtRQUFPWSxXQUFXO0lBQW9CO0lBRTlFLDBGQUEwRjtJQUMxRixNQUFNQyxrQkFBa0IsTUFBTW5DLHVCQUF1QlksT0FBUW9CO0lBRTdELE1BQU1JLFFBQWlDO1FBQ3JDakI7UUFDQUMsTUFBTUEsUUFBUTtRQUNkaUIscUJBQXFCMUMsU0FBU0QsU0FBU0MsS0FBSztRQUM1QzJDLGdCQUFnQjFDLFlBQVlGLFNBQVNFLFFBQVE7UUFDN0MyQyxjQUFjMUMsVUFBVUgsU0FBU0csTUFBTTtRQUN2Q0MsWUFBWUEsY0FBY0osU0FBU0ksVUFBVTtRQUM3Q0MsWUFBWUEsY0FBY0wsU0FBU0ssVUFBVTtRQUM3Q3lDLGFBQWE7UUFDYkMsZUFBZTtRQUNmQyxnQkFBZ0I7SUFDbEI7SUFFQSxNQUFNQyxTQUFVLE1BQU1YLFVBQVVZLEdBQUcsQ0FBQ1QsaUJBQXdCO1FBQUVDO0lBQU07SUFDcEUsTUFBTVMsUUFBUUMsTUFBTUMsT0FBTyxDQUFDSixVQUFVQSxNQUFNLENBQUMsRUFBRSxHQUFHQTtJQUNsRCxNQUFNSyxXQUFtQixPQUFPSCxVQUFVLFdBQVdBLFFBQVFBLE9BQU9JLFdBQVdDLE9BQU9MO0lBQ3RGLE9BQU87UUFBRUc7UUFBVUcsTUFBTTtZQUFFeEQsT0FBT0QsU0FBU0MsS0FBSztZQUFFQyxVQUFVRixTQUFTRSxRQUFRO1lBQUVDLFFBQVFILFNBQVNHLE1BQU07UUFBQztJQUFFO0FBQzNHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2FjcmVkLXN0eWxlcy13ZWIvLi9zcmMvbGliL3Byb3ZpZGVyL3JlcGxpY2F0ZS50cz8wYjBhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZXBsaWNhdGUgZnJvbSAncmVwbGljYXRlJztcblxudHlwZSBSdW5BcmdzID0ge1xuICBwcm9tcHQ6IHN0cmluZztcbiAgc2VlZD86IG51bWJlcjtcbiAgc3RlcHM/OiBudW1iZXI7XG4gIGd1aWRhbmNlPzogbnVtYmVyO1xuICBhc3BlY3Q/OiAnMToxJyB8ICczOjQnIHwgJzQ6Myc7XG4gIG1lZ2FwaXhlbHM/OiAnMScgfCAnMS41JztcbiAgbG9yYV9zY2FsZT86IG51bWJlcjtcbiAgc2lnbmFsPzogQWJvcnRTaWduYWw7XG59O1xuXG5jb25zdCBERUZBVUxUUyA9IHtcbiAgc3RlcHM6IDMyLFxuICBndWlkYW5jZTogNC4yLFxuICBhc3BlY3Q6ICczOjQnIGFzIGNvbnN0LFxuICBtZWdhcGl4ZWxzOiAnMScgYXMgY29uc3QsXG4gIGxvcmFfc2NhbGU6IDFcbn07XG5cbmFzeW5jIGZ1bmN0aW9uIHJlc29sdmVNb2RlbElkZW50aWZpZXIocmF3TW9kZWw6IHN0cmluZywgY2xpZW50OiBSZXBsaWNhdGUpOiBQcm9taXNlPHN0cmluZz4ge1xuICAvLyBBbGxvdyBlbnYgZm9ybXM6IFwib3duZXIvbW9kZWw6dmVyc2lvblwiLCBcIm93bmVyL21vZGVsOmxhdGVzdFwiLCBvciBqdXN0IFwib3duZXIvbW9kZWxcIlxuICBjb25zdCBoYXNWZXJzaW9uID0gcmF3TW9kZWwuaW5jbHVkZXMoJzonKSAmJiAhcmF3TW9kZWwuZW5kc1dpdGgoJzpsYXRlc3QnKTtcbiAgaWYgKGhhc1ZlcnNpb24pIHJldHVybiByYXdNb2RlbDtcblxuICBjb25zdCBzbHVnID0gcmF3TW9kZWwucmVwbGFjZSgnOmxhdGVzdCcsICcnKTtcbiAgY29uc3QgW293bmVyLCBuYW1lXSA9IHNsdWcuc3BsaXQoJy8nKTtcbiAgaWYgKCFvd25lciB8fCAhbmFtZSkgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIG1vZGVsIHNsdWc7IGV4cGVjdGVkIFwib3duZXIvbW9kZWxcIicpO1xuICBjb25zdCBtb2RlbCA9IGF3YWl0IChjbGllbnQgYXMgYW55KS5tb2RlbHMuZ2V0KG93bmVyLCBuYW1lKTtcbiAgY29uc3QgbGF0ZXN0VmVyc2lvbklkID0gKG1vZGVsIGFzIGFueSk/LmxhdGVzdF92ZXJzaW9uPy5pZDtcbiAgaWYgKCFsYXRlc3RWZXJzaW9uSWQpIHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIHJlc29sdmUgbGF0ZXN0IG1vZGVsIHZlcnNpb24nKTtcbiAgcmV0dXJuIGAkeyhtb2RlbCBhcyBhbnkpLm93bmVyfS8keyhtb2RlbCBhcyBhbnkpLm5hbWV9OiR7bGF0ZXN0VmVyc2lvbklkfWA7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBydW5SZXBsaWNhdGUoeyBwcm9tcHQsIHNlZWQsIHN0ZXBzLCBndWlkYW5jZSwgYXNwZWN0LCBtZWdhcGl4ZWxzLCBsb3JhX3NjYWxlLCBzaWduYWwgfTogUnVuQXJncyk6IFByb21pc2U8e1xuICBpbWFnZVVybDogc3RyaW5nO1xuICBtZXRhOiB7IHN0ZXBzOiBudW1iZXI7IGd1aWRhbmNlOiBudW1iZXI7IGFzcGVjdDogc3RyaW5nIH07XG59PiB7XG4gIGNvbnN0IHRva2VuID0gcHJvY2Vzcy5lbnYuUkVQTElDQVRFX0FQSV9UT0tFTjtcbiAgY29uc3QgbW9kZWwgPSBwcm9jZXNzLmVudi5SRVBMSUNBVEVfTU9ERUw7XG4gIGNvbnNvbGUubG9nKCdbcmVwbGljYXRlXSBlbnYgc2V0OicsIHtcbiAgICBoYXNUb2tlbjogQm9vbGVhbih0b2tlbiksXG4gICAgaGFzTW9kZWw6IEJvb2xlYW4obW9kZWwpXG4gIH0pO1xuICBpZiAoIXRva2VuIHx8ICFtb2RlbCkgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIFJlcGxpY2F0ZSBlbnYgdmFycycpO1xuXG4gIGNvbnN0IHJlcGxpY2F0ZSA9IG5ldyBSZXBsaWNhdGUoeyBhdXRoOiB0b2tlbiwgdXNlckFnZW50OiAnc2FjcmVkLXN0eWxlcy13ZWInIH0pO1xuXG4gIC8vIFN1cHBvcnQgdmVyc2lvbmxlc3Mgb3IgXCI6bGF0ZXN0XCIgbW9kZWwgcmVmZXJlbmNlcyBieSByZXNvbHZpbmcgdG8gdGhlIGxhdGVzdCB2ZXJzaW9uIGlkXG4gIGNvbnN0IG1vZGVsSWRlbnRpZmllciA9IGF3YWl0IHJlc29sdmVNb2RlbElkZW50aWZpZXIobW9kZWwhLCByZXBsaWNhdGUpO1xuXG4gIGNvbnN0IGlucHV0OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHtcbiAgICBwcm9tcHQsXG4gICAgc2VlZDogc2VlZCA/PyA4OSxcbiAgICBudW1faW5mZXJlbmNlX3N0ZXBzOiBzdGVwcyA/PyBERUZBVUxUUy5zdGVwcyxcbiAgICBndWlkYW5jZV9zY2FsZTogZ3VpZGFuY2UgPz8gREVGQVVMVFMuZ3VpZGFuY2UsXG4gICAgYXNwZWN0X3JhdGlvOiBhc3BlY3QgPz8gREVGQVVMVFMuYXNwZWN0LFxuICAgIG1lZ2FwaXhlbHM6IG1lZ2FwaXhlbHMgPz8gREVGQVVMVFMubWVnYXBpeGVscyxcbiAgICBsb3JhX3NjYWxlOiBsb3JhX3NjYWxlID8/IERFRkFVTFRTLmxvcmFfc2NhbGUsXG4gICAgbnVtX291dHB1dHM6IDEsXG4gICAgb3V0cHV0X2Zvcm1hdDogJ3dlYnAnLFxuICAgIG91dHB1dF9xdWFsaXR5OiA4MFxuICB9O1xuXG4gIGNvbnN0IG91dHB1dCA9IChhd2FpdCByZXBsaWNhdGUucnVuKG1vZGVsSWRlbnRpZmllciBhcyBhbnksIHsgaW5wdXQgfSkpIGFzIGFueTtcbiAgY29uc3QgZmlyc3QgPSBBcnJheS5pc0FycmF5KG91dHB1dCkgPyBvdXRwdXRbMF0gOiBvdXRwdXQ7XG4gIGNvbnN0IGltYWdlVXJsOiBzdHJpbmcgPSB0eXBlb2YgZmlyc3QgPT09ICdzdHJpbmcnID8gZmlyc3QgOiBmaXJzdD8udXJsPy4oKSA/PyBTdHJpbmcoZmlyc3QpO1xuICByZXR1cm4geyBpbWFnZVVybCwgbWV0YTogeyBzdGVwczogREVGQVVMVFMuc3RlcHMsIGd1aWRhbmNlOiBERUZBVUxUUy5ndWlkYW5jZSwgYXNwZWN0OiBERUZBVUxUUy5hc3BlY3QgfSB9O1xufVxuXG4iXSwibmFtZXMiOlsiUmVwbGljYXRlIiwiREVGQVVMVFMiLCJzdGVwcyIsImd1aWRhbmNlIiwiYXNwZWN0IiwibWVnYXBpeGVscyIsImxvcmFfc2NhbGUiLCJyZXNvbHZlTW9kZWxJZGVudGlmaWVyIiwicmF3TW9kZWwiLCJjbGllbnQiLCJoYXNWZXJzaW9uIiwiaW5jbHVkZXMiLCJlbmRzV2l0aCIsInNsdWciLCJyZXBsYWNlIiwib3duZXIiLCJuYW1lIiwic3BsaXQiLCJFcnJvciIsIm1vZGVsIiwibW9kZWxzIiwiZ2V0IiwibGF0ZXN0VmVyc2lvbklkIiwibGF0ZXN0X3ZlcnNpb24iLCJpZCIsInJ1blJlcGxpY2F0ZSIsInByb21wdCIsInNlZWQiLCJzaWduYWwiLCJ0b2tlbiIsInByb2Nlc3MiLCJlbnYiLCJSRVBMSUNBVEVfQVBJX1RPS0VOIiwiUkVQTElDQVRFX01PREVMIiwiY29uc29sZSIsImxvZyIsImhhc1Rva2VuIiwiQm9vbGVhbiIsImhhc01vZGVsIiwicmVwbGljYXRlIiwiYXV0aCIsInVzZXJBZ2VudCIsIm1vZGVsSWRlbnRpZmllciIsImlucHV0IiwibnVtX2luZmVyZW5jZV9zdGVwcyIsImd1aWRhbmNlX3NjYWxlIiwiYXNwZWN0X3JhdGlvIiwibnVtX291dHB1dHMiLCJvdXRwdXRfZm9ybWF0Iiwib3V0cHV0X3F1YWxpdHkiLCJvdXRwdXQiLCJydW4iLCJmaXJzdCIsIkFycmF5IiwiaXNBcnJheSIsImltYWdlVXJsIiwidXJsIiwiU3RyaW5nIiwibWV0YSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/provider/replicate.ts\n");

/***/ })

};
;